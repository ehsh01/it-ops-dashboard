if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Ot=class extends P{static[m]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};var yu=class extends Ot{static[m]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new xu(e,this.config)}},xu=class extends S{static[m]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},bu=class extends Ot{static[m]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new wu(e,this.config)}},wu=class extends S{static[m]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};function Px(t,e){let{name:r,config:n}=Q(t,e);return n.mode==="number"?new yu(r):new bu(r)}var Su=class extends P{static[m]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new _u(e,this.config)}},_u=class extends S{static[m]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Eu=class extends P{static[m]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Tu(e,this.config)}},Tu=class extends S{static[m]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function Ix(t,e){let{name:r,config:n}=Q(t,e);return n.mode==="number"?new Su(r):new Eu(r)}var Cu=class extends P{static[m]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new ku(e,this.config)}},ku=class extends S{static[m]="PgBoolean";getSQLType(){return"boolean"}};function Ga(t){return new Cu(t??"")}var Au=class extends P{static[m]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Pu(e,this.config)}},Pu=class extends S{static[m]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function qx(t,e={}){let{name:r,config:n}=Q(t,e);return new Au(r,n)}var Iu=class extends P{static[m]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new qu(e,this.config)}},qu=class extends S{static[m]="PgCidr";getSQLType(){return"cidr"}};function Ox(t){return new Iu(t??"")}var Ou=class extends P{static[m]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new Nu(e,this.config)}},Nu=class extends S{static[m]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function Nx(t){return(e,r)=>{let{name:n,config:i}=Q(e,r);return new Ou(n,i,t)}}var gt=class extends P{static[m]="PgDateColumnBaseBuilder";defaultNow(){return this.default(h`now()`)}};var ju=class extends gt{static[m]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new ni(e,this.config)}},ni=class extends S{static[m]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},Ru=class extends gt{static[m]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new ii(e,this.config)}},ii=class extends S{static[m]="PgDateString";getSQLType(){return"date"}};function jx(t,e){let{name:r,config:n}=Q(t,e);return n?.mode==="date"?new ju(r):new Ru(r)}var Fu=class extends P{static[m]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Mu(e,this.config)}},Mu=class extends S{static[m]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function Rx(t){return new Fu(t??"")}var Du=class extends P{static[m]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new Lu(e,this.config)}},Lu=class extends S{static[m]="PgInet";getSQLType(){return"inet"}};function Fx(t){return new Du(t??"")}var Bu=class extends Ot{static[m]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new $u(e,this.config)}},$u=class extends S{static[m]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function Ka(t){return new Bu(t??"")}var zu=class extends P{static[m]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new Uu(e,this.config)}},Uu=class extends S{static[m]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}};function Mx(t,e={}){let{name:r,config:n}=Q(t,e);return new zu(r,n)}var Qu=class extends P{static[m]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ai(e,this.config)}},ai=class extends S{static[m]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Dx(t){return new Qu(t??"")}var Vu=class extends P{static[m]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new si(e,this.config)}},si=class extends S{static[m]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Lx(t){return new Vu(t??"")}var Hu=class extends P{static[m]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Gu(e,this.config)}},Gu=class extends S{static[m]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ku=class extends P{static[m]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Wu(e,this.config)}},Wu=class extends S{static[m]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function Bx(t,e){let{name:r,config:n}=Q(t,e);return!n?.mode||n.mode==="tuple"?new Hu(r):new Ku(r)}var Zu=class extends P{static[m]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Xu(e,this.config)}},Xu=class extends S{static[m]="PgMacaddr";getSQLType(){return"macaddr"}};function $x(t){return new Zu(t??"")}var Ju=class extends P{static[m]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Yu(e,this.config)}},Yu=class extends S{static[m]="PgMacaddr8";getSQLType(){return"macaddr8"}};function zx(t){return new Ju(t??"")}var el=class extends P{static[m]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new oi(e,this.config)}},oi=class extends S{static[m]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function Ux(t,e){let{name:r,config:n}=Q(t,e);return new el(r,n?.precision,n?.scale)}var tl=class extends P{static[m]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new rl(e,this.config)}},rl=class extends S{static[m]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},nl=class extends P{static[m]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new il(e,this.config)}},il=class extends S{static[m]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function Qx(t,e){let{name:r,config:n}=Q(t,e);return!n?.mode||n.mode==="tuple"?new tl(r):new nl(r)}function tC(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function Vx(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function al(t){let e=tC(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=Vx(e,r);r+=8;let u=Vx(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var sl=class extends P{static[m]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new ol(e,this.config)}},ol=class extends S{static[m]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return al(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},cl=class extends P{static[m]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new ul(e,this.config)}},ul=class extends S{static[m]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=al(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function Hx(t,e){let{name:r,config:n}=Q(t,e);return!n?.mode||n.mode==="tuple"?new sl(r):new cl(r)}var ll=class extends P{static[m]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new pl(e,this.config)}},pl=class extends S{static[m]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};function Gx(t){return new ll(t??"")}var dl=class extends P{static[m]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new fl(e,this.config)}},fl=class extends S{static[m]="PgSerial";getSQLType(){return"serial"}};function Kx(t){return new dl(t??"")}var ml=class extends Ot{static[m]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new hl(e,this.config)}},hl=class extends S{static[m]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};function Wx(t){return new ml(t??"")}var vl=class extends P{static[m]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new gl(e,this.config)}},gl=class extends S{static[m]="PgSmallSerial";getSQLType(){return"smallserial"}};function Zx(t){return new vl(t??"")}var yl=class extends P{static[m]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new xl(e,this.config)}},xl=class extends S{static[m]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};function fe(t,e={}){let{name:r,config:n}=Q(t,e);return new yl(r,n)}var bl=class extends gt{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[m]="PgTimeBuilder";build(e){return new ci(e,this.config)}},ci=class extends S{static[m]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Xx(t,e={}){let{name:r,config:n}=Q(t,e);return new bl(r,n.withTimezone??!1,n.precision)}var wl=class extends gt{static[m]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new ui(e,this.config)}},ui=class extends S{static[m]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Sl=class extends gt{static[m]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new li(e,this.config)}},li=class extends S{static[m]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function pi(t,e={}){let{name:r,config:n}=Q(t,e);return n?.mode==="string"?new Sl(r,n.withTimezone??!1,n.precision):new wl(r,n?.withTimezone??!1,n?.precision)}var _l=class extends P{static[m]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(h`gen_random_uuid()`)}build(e){return new di(e,this.config)}},di=class extends S{static[m]="PgUUID";getSQLType(){return"uuid"}};function Jx(t){return new _l(t??"")}var El=class extends P{static[m]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Tl(e,this.config)}},Tl=class extends S{static[m]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function Vt(t,e={}){let{name:r,config:n}=Q(t,e);return new El(r,n)}var Cl=class extends P{static[m]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new kl(e,this.config)}},kl=class extends S{static[m]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}};function Yx(t,e){let{name:r,config:n}=Q(t,e);return new Cl(r,n)}var Al=class extends P{static[m]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new Pl(e,this.config)}},Pl=class extends S{static[m]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}};function eb(t,e){let{name:r,config:n}=Q(t,e);return new Al(r,n)}var Il=class extends P{static[m]="PgSparseVectorBuilder";constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new ql(e,this.config)}},ql=class extends S{static[m]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function tb(t,e){let{name:r,config:n}=Q(t,e);return new Il(r,n)}var Ol=class extends P{static[m]="PgVectorBuilder";constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new Nl(e,this.config)}},Nl=class extends S{static[m]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}};function rb(t,e){let{name:r,config:n}=Q(t,e);return new Ol(r,n)}function nb(){return{bigint:Px,bigserial:Ix,boolean:Ga,char:qx,cidr:Ox,customType:Nx,date:jx,doublePrecision:Rx,inet:Fx,integer:Ka,interval:Mx,json:Dx,jsonb:Lx,line:Bx,macaddr:$x,macaddr8:zx,numeric:Ux,point:Qx,geometry:Hx,real:Gx,serial:Kx,smallint:Wx,smallserial:Zx,text:fe,time:Xx,timestamp:pi,uuid:Jx,varchar:Vt,bit:Yx,halfvec:eb,sparsevec:tb,vector:rb}}var jl=Symbol.for("drizzle:PgInlineForeignKeys"),ib=Symbol.for("drizzle:EnableRLS"),ye=class extends C{static[m]="PgTable";static Symbol=Object.assign({},C.Symbol,{InlineForeignKeys:jl,EnableRLS:ib});[jl]=[];[ib]=!1;[C.Symbol.ExtraConfigBuilder]=void 0};function rC(t,e,r,n,i=t){let a=new ye(t,n,i),s=typeof e=="function"?e(nb()):e,o=Object.fromEntries(Object.entries(s).map(([l,p])=>{let d=p;d.setName(l);let f=d.build(a);return a[jl].push(...d.buildForeignKeys(f,a)),[l,f]})),u=Object.fromEntries(Object.entries(s).map(([l,p])=>{let d=p;d.setName(l);let f=d.buildExtraConfigColumn(a);return[l,f]})),c=Object.assign(a,o);return c[C.Symbol.Columns]=o,c[C.Symbol.ExtraConfigColumns]=u,r&&(c[ye.Symbol.ExtraConfigBuilder]=r),Object.assign(c,{enableRLS:()=>(c[ye.Symbol.EnableRLS]=!0,c)})}var Wa=(t,e,r)=>rC(t,e,r,void 0);var Za=class{static[m]="PgPrimaryKeyBuilder";columns;name;constructor(e,r){this.columns=e,this.name=r}build(e){return new Rl(e,this.columns,this.name)}},Rl=class{constructor(e,r,n){this.table=e,this.columns=r,this.name=n}static[m]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[ye.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};var Xa=class{constructor(e,r,n){this.sourceTable=e,this.referencedTable=r,this.relationName=n,this.referencedTableName=r[C.Symbol.Name]}static[m]="Relation";referencedTableName;fieldName},Fl=class{constructor(e,r){this.table=e,this.config=r}static[m]="Relations"},Ht=class t extends Xa{constructor(e,r,n,i){super(e,r,n?.relationName),this.config=n,this.isNullable=i}static[m]="One";withFieldName(e){let r=new t(this.sourceTable,this.referencedTable,this.config,this.isNullable);return r.fieldName=e,r}},fi=class t extends Xa{constructor(e,r,n){super(e,r,n?.relationName),this.config=n}static[m]="Many";withFieldName(e){let r=new t(this.sourceTable,this.referencedTable,this.config);return r.fieldName=e,r}};function ab(){return{and:mr,between:yx,eq:qe,exists:vx,gt:cx,gte:ux,ilike:Sx,inArray:dx,isNull:mx,isNotNull:hx,like:bx,lt:lx,lte:px,ne:ax,not:ox,notBetween:xx,notExists:gx,notLike:wx,notIlike:_x,notInArray:fx,or:sx,sql:h}}function sb(){return{sql:h,asc:Ex,desc:za}}function ob(t,e){Object.keys(t).length===1&&"default"in t&&!b(t.default,C)&&(t=t.default);let r={},n={},i={};for(let[a,s]of Object.entries(t))if(b(s,C)){let o=dr(s),u=n[o];r[o]=a,i[a]={tsName:a,dbName:s[C.Symbol.Name],schema:s[C.Symbol.Schema],columns:s[C.Symbol.Columns],relations:u?.relations??{},primaryKey:u?.primaryKey??[]};for(let l of Object.values(s[C.Symbol.Columns]))l.primary&&i[a].primaryKey.push(l);let c=s[C.Symbol.ExtraConfigBuilder]?.(s[C.Symbol.ExtraConfigColumns]);if(c)for(let l of Object.values(c))b(l,Za)&&i[a].primaryKey.push(...l.columns)}else if(b(s,Fl)){let o=dr(s.table),u=r[o],c=s.config(e(s.table)),l;for(let[p,d]of Object.entries(c))if(u){let f=i[u];f.relations[p]=d,l&&f.primaryKey.push(...l)}else o in n||(n[o]={relations:{},primaryKey:l}),n[o].relations[p]=d}return{tables:i,tableNamesMap:r}}function nC(t){return function(r,n){return new Ht(t,r,n,n?.fields.reduce((i,a)=>i&&a.notNull,!0)??!1)}}function iC(t){return function(r,n){return new fi(t,r,n)}}function cb(t,e,r){if(b(r,Ht)&&r.config)return{fields:r.config.fields,references:r.config.references};let n=e[dr(r.referencedTable)];if(!n)throw new Error(`Table "${r.referencedTable[C.Symbol.Name]}" not found in schema`);let i=t[n];if(!i)throw new Error(`Table "${n}" not found in schema`);let a=r.sourceTable,s=e[dr(a)];if(!s)throw new Error(`Table "${a[C.Symbol.Name]}" not found in schema`);let o=[];for(let u of Object.values(i.relations))(r.relationName&&r!==u&&u.relationName===r.relationName||!r.relationName&&u.referencedTable===r.sourceTable)&&o.push(u);if(o.length>1)throw r.relationName?new Error(`There are multiple relations with name "${r.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${r.sourceTable[C.Symbol.Name]}". Please specify relation name`);if(o[0]&&b(o[0],Ht)&&o[0].config)return{fields:o[0].config.references,references:o[0].config.fields};throw new Error(`There is not enough information to infer relation "${s}.${r.fieldName}"`)}function ub(t){return{one:nC(t),many:iC(t)}}function Ja(t,e,r,n,i=a=>a){let a={};for(let[s,o]of n.entries())if(o.isJson){let u=e.relations[o.tsKey],c=r[s],l=typeof c=="string"?JSON.parse(c):c;a[o.tsKey]=b(u,Ht)?l&&Ja(t,t[o.relationTableTsKey],l,o.selection,i):l.map(p=>Ja(t,t[o.relationTableTsKey],p,o.selection,i))}else{let u=i(r[s]),c=o.field,l;b(c,G)?l=c:b(c,A)?l=c.decoder:l=c.sql.decoder,a[o.tsKey]=u===null?null:l.mapFromDriverValue(u)}return a}var ie=class t{static[m]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===Z)return{...e[Z],selectedFields:new Proxy(e[Z].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(b(e,ue)?e._.selectedFields:b(e,Ie)?e[Z].selectedFields:e)[r];if(b(i,A.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(b(i,A)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return b(i,G)?this.config.alias?new Proxy(i,new fr(new Proxy(i.table,new rn(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}};var mi=class extends Ce{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[m]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[C.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return W.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new ie({alias:je(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};function aC(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function sC(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function oC(t){return t}var Ya=class{static[m]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?aC:e==="camelCase"?sC:oC}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[C.Symbol.Schema]??"public",n=e.table[C.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[C.Symbol.Schema]??"public",n=e[C.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[C.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}};var nn=class extends Ie{static[m]="PgViewBase"};var Gt=class{static[m]="PgDialect";casing;constructor(e){this.casing=new Ya(e?.casing)}async migrate(e,r,n){let i=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",a=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",s=h`
48|it-ops-dashboard  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
48|it-ops-dashboard  | Error: self-signed certificate in certificate chain
48|it-ops-dashboard  |     at /var/www/it-ops-dashboard/dist/index.cjs:59:14227
48|it-ops-dashboard  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
48|it-ops-dashboard  |     at async /var/www/it-ops-dashboard/dist/index.cjs:65:96955
48|it-ops-dashboard  |     at async Jp.getUserByUsername (/var/www/it-ops-dashboard/dist/index.cjs:65:100036)
48|it-ops-dashboard  |     at async /var/www/it-ops-dashboard/dist/index.cjs:65:101459 {
48|it-ops-dashboard  |   code: 'SELF_SIGNED_CERT_IN_CHAIN'
48|it-ops-dashboard  | }
48|it-ops-dashboard  | Node.js v20.19.6
